# Tinder Neural Network Like
###### Tinder, I'm sorry.
###### I did this because I was interested in sounding neural networks and the structure of the web.
###### I did this for the purposes of self-education.



# Введение
##### Tinder Neural Network Like (далее - TNNL), в режиме реального времени, полностью автономно, без вашего участия может лайкать или дизлайкать пользователей сети Tinder по вашим интересам при помощи нейросетей (их тут аж 5 штук).
###### То есть не в тупую, а имеено тех пользователей, которые предположительно вам будут интересны.
###### О всех алгоритмах, нюансах и точности работы будет описано ниже.
###### Идея разработки - самообразование. Проект был сложным и невероятно интригующим.
###### Реализовано на: Golang, React, Typescript, Python, Tensorflow, GRPC

# Установка / Запуск
###### Для работы потребуется установленный Python версии 3.9 (простите меня пожалуйста, не я такой, жизнь такая), в интернете куча гайдов как его поставить.
###### Пока только под MacOS, Windows будет позже.
###### 1) Загружаете и распаковываете 7z TNNL под вашу ОС
###### 2) Загружаете все зависимости для FaceDetect (Python) открыв скрипт в директории: ./TNNL/facedetect/install_FaceDetect_dependencies.(command/bat)
###### 3) Запускаете сам TNNL: ./TNNL/start_TNNL.(command/bat)
###### 4) Открываете в браузере: localhost:8090
###### 5) ??????? PROFIT!11!1111!!!!
###### to dev
###### ./yarn run build
###### ./yarn run dev
###### ./go run tnn.go
###### ./grpctranport/generate.txt

# Инструкция
### Интерфейс адаптирован под телефон, так что набивать датасет можно где угодно из локальной сети (хоть сидя на унитазе)

###### Первым делом после запуска необходимо на вкладке "Настройки" ввести токен от тиндера, [инструкция](/front/TokenTutorial.mp4) как и где его достать доступна по кнопке "Где взять токен?"
###### После чего загрузить профили по которым будете обучать нейросеть под себя на вкладке "Загрузка" (не волнуйтесь, 4 нейронки все сделют за вас, отсеят нужные от ненужных)
###### После загрузки на вкладке "Обучение нейронной сети" свайпаем пользователей как в тиндере (предсказание в режиме реального времени начинает работать только после обучения, его можно сделать и предварительно), насвайпать желательно как минимум 10 000 фотографий в обе категории (т.е 20 000), не пугайтесь, свайпаете вы не фотографии, а ПОЛЬЗОВАТЕЛЕЙ, по этому реальное число свайпов можно смело делить на 3-5
###### Как насвайпали, лезем в настройки и обучаем свою нейронку (после этого на вкладке "Обучение нейронной сети" начнет работать предсказание пользователей в режиме реального времени)
###### Все, можно запускать автолайк на вкладке "Автолайк", все результаты работы будут выведены на экран.


# Матчасть
## Проект состоит из 2х программ:
### TNN - Golang
###### Здесь вся логика (Вебсервер, общение с серверами Tinder, защита от "дурака" и тд)
### faceDetect - Python
###### Здесь только нейросети (Tensorflow), тут я допустил огромную ошибку.
###### В чем же заключается ошибка?
###### Python - вот сплошная ошибка.
###### Если бы я только знал... - я бы это реализовал на C++, но как всегда было уже поздно :(
###### (судя по всему это мой первый и последний опыт с python)

## Обработка фотографий (загрузка или автолайк)
###### Обработка фотографий происходит прозрачно для пользователя, скачиваются только те, что подходят
###### А подходят только фотографии с ОДНИМ, НЕ ЗАКРЫТЫМ, ПОД ПРЯМЫМ УГЛОМ, ОТЛИЧНО ВИДНЫМ лицом
## Алгоритм в 5 этапов:
###### 1) MTCNN - распознает границы лица на фотографии и сегментирует его (делает это не всегода идеально, по этому на 5м этапе мной была написана и обучена нейросеть на валидацию)
###### 2) Алгоритмом [RotateAndCutFace](/components/faceDetection.go#L109) при помощи курса тригонометрии за 9-11 класс вычисляет угол поворота относительно положения рта и вырезает из фотографии портрет "как на паспорт" разрешением 128x128
###### 3) При помощи уже обученной модели нейронной сети [deconv_bnoptimized_munet.h5](https://github.com/anilsathyan7/Portrait-Segmentation/tree/master/models/transpose_seg) от [anilsathyan7](https://github.com/anilsathyan7) (спасибо, сэкономило кучу времени) вырезает задний фон у портрета
###### 4) Конвертирует изображение в черно-белое, таким образом все фотографии будут более "общими" по типажу
###### 5) Обученная мной нейросеть проводит валидацию на предмет качества видимости лица на портрете возвращая число от .0 до 1 (обучена на 15 000 вручную классифицированных фотографиях)

### Пример работы:
<img src="gitMedia/validation_example.jpg"/>

### Пример в режиме реального времени во время загрузки (как же оно идеально отрабатыввет... кайф...):
<img src="gitMedia/downloadForms.gif"/>


# [Все примеры (GIF)](GIFs.md)